---
name: data-weixin-mp
description: "通过 Browser RPA 拉取微信公众号创作数据"
user-invocable: false
metadata: {"openclaw":{"requires":{"config":["browser.enabled"]}}}
---

# 微信公众号数据拉取 RPA Skill

## 概述
通过浏览器自动化操作微信公众号后台 (https://mp.weixin.qq.com)，提取文章阅读、互动和粉丝数据。

## 前置条件
- Browser Profile `weixin-mp` 已创建且已登录

## RPA 操作步骤

### 1. 检查登录
profile=weixin-mp，导航到 `https://mp.weixin.qq.com`。
执行 `browser snapshot` 检查登录态。
如果出现 "扫码登录" → 中断，通知创作者。

### 2. 进入数据中心
导航到公众号后台的「统计」或「数据分析」模块。
等待数据页面加载完成。

### 3. 提取粉丝数据
执行 `browser snapshot`，提取：
- 总粉丝数
- 新增粉丝（今日/近7日/近30日）
- 取关粉丝数
- 净增粉丝数

### 4. 提取文章数据
导航到「内容分析」或「图文分析」页面，提取近期文章：
- 文章标题
- 阅读量
- 分享数
- 在看数
- 留言数
- 发布时间

### 5. 提取公众号概览
导航到首页概览，提取：
- 昨日阅读总量
- 昨日分享总量
- 消息数

### 6. 保存数据快照
保存到 `workspace/data/weixin-mp-YYYY-MM-DD.md`：
```markdown
# 微信公众号数据快照 - <日期>

## 粉丝概览
- 总粉丝: xxx
- 新增粉丝 (7日): +xxx
- 净增粉丝 (7日): +xxx

## 昨日概览
- 阅读总量: xxx
- 分享总量: xxx

## 近期文章
| 标题 | 阅读 | 分享 | 在看 | 留言 | 发布时间 |
|------|------|------|------|------|----------|
| ...  | ...  | ...  | ...  | ...  | ...      |
```

### 7. 返回数据摘要
供日报或 `/data` 指令使用。

## 异常处理
- 未登录 → 中断，提示 /login weixin-mp（公众号登录需扫码，较易过期）
- 页面加载超时 → 刷新重试一次
- 数据页面改版 → 截图当前页面，通知创作者手动检查
