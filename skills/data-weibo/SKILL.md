---
name: data-weibo
description: "通过 Browser RPA 拉取微博创作者数据"
user-invocable: false
metadata: {"openclaw":{"requires":{"config":["browser.enabled"]}}}
---

# 微博数据拉取 RPA Skill

## 概述
通过浏览器自动化操作微博 (https://weibo.com)，提取微博互动、粉丝和影响力数据。

> **参考**: MediaCrawler 项目 (NanmiCoder/MediaCrawler) 中的微博数据抓取逻辑。

## 前置条件
- Browser Profile `weibo` 已创建且已登录

## RPA 操作步骤

### 1. 检查登录
profile=weibo，导航到 `https://weibo.com`。
执行 `browser snapshot` 检查登录态。
如果出现 "登录" → 中断，通知创作者。

### 2. 进入个人主页
导航到个人主页或创作者后台。

### 3. 提取账号数据
执行 `browser snapshot`，提取：
- 总粉丝数 / 新增粉丝
- 总关注数
- 总微博数
- 微博等级/影响力指数

### 4. 提取微博数据
浏览个人主页微博列表，提取近期微博：
- 微博内容摘要
- 转发数
- 评论数
- 点赞数
- 发布时间

### 5. 提取热门微博
识别互动量最高的微博（排序或筛选）：
- 热门话题参与度
- 爆款微博特征分析

### 6. 保存数据快照
保存到 `workspace/data/weibo-YYYY-MM-DD.md`：
```markdown
# 微博数据快照 - <日期>

## 账号概览
- 总粉丝: xxx
- 新增粉丝 (7日): +xxx
- 总微博数: xxx

## 近期微博
| 内容摘要 | 转发 | 评论 | 点赞 | 发布时间 |
|----------|------|------|------|----------|
| ...      | ...  | ...  | ...  | ...      |

## 热门微博 TOP5
| 内容摘要 | 转发 | 评论 | 点赞 | 发布时间 |
|----------|------|------|------|----------|
| ...      | ...  | ...  | ...  | ...      |
```

### 7. 返回数据摘要

## 反爬策略
> 参考: MediaCrawler 项目 (NanmiCoder/MediaCrawler) 的反爬经验

微博反爬中等：
- **操作间隔**：每次操作间等待 1.5-2 秒
- **翻页间隔**：翻页后等待 2-3 秒（随机）
- **登录态必须**：未登录状态数据获取严重受限
- **频率限制**：微博对频繁访问有限制，单次拉取控制在 20 条以内

## 异常处理
- 未登录 → 中断，提示 /login weibo
- 反爬验证码 → 截图 + 通知创作者手动处理（通过 VNC）
- 页面加载慢 → 等待 15 秒后重试
- 微博限制频繁访问 → 等待 5 分钟后重试
